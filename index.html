<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Datenkommunikation 1 – Lernapp (Textfragen) – 2.2.2 bis 15.2.3</title>
  <style>
    :root{
      --bg:#0b1020;
      --panel:#111a33;
      --panel2:#0f1730;
      --text:#e8eeff;
      --muted:#a9b6e6;
      --accent:#7aa2ff;
      --accent2:#6ee7ff;
      --ok:#2ee59d;
      --bad:#ff6b8b;
      --warn:#ffd36e;
      --border:rgba(255,255,255,.10);
      --shadow: 0 12px 30px rgba(0,0,0,.35);
      --radius:16px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Noto Sans", "Liberation Sans", sans-serif;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:var(--sans);
      color:var(--text);
      background:
        radial-gradient(900px 600px at 20% -10%, rgba(122,162,255,.28), transparent 60%),
        radial-gradient(900px 600px at 95% 5%, rgba(110,231,255,.16), transparent 55%),
        radial-gradient(800px 600px at 30% 110%, rgba(46,229,157,.10), transparent 60%),
        var(--bg);
      min-height:100vh;
    }
    header{
      padding:22px 18px 14px;
      border-bottom:1px solid var(--border);
      background: linear-gradient(180deg, rgba(17,26,51,.85), rgba(17,26,51,.55));
      backdrop-filter: blur(10px);
      position: sticky;
      top: 0;
      z-index: 50;
    }
    .wrap{max-width:1100px;margin:0 auto;padding:0 14px;}
    .toprow{display:flex;gap:12px;align-items:flex-end;justify-content:space-between;flex-wrap:wrap}
    h1{
      margin:0;
      font-size:18px;
      letter-spacing:.2px;
      font-weight:700;
    }
    .subtitle{
      margin-top:6px;
      color:var(--muted);
      font-size:12.5px;
      line-height:1.35;
    }
    .tabs{
      display:flex;
      gap:8px;
      align-items:center;
      flex-wrap:wrap;
    }
    .tabbtn{
      border:1px solid var(--border);
      background:rgba(15,23,48,.7);
      color:var(--text);
      padding:9px 12px;
      border-radius:999px;
      cursor:pointer;
      font-weight:650;
      font-size:13px;
      transition:transform .08s ease, background .2s ease, border-color .2s ease;
    }
    .tabbtn:hover{transform:translateY(-1px); border-color: rgba(122,162,255,.45)}
    .tabbtn.active{
      background: linear-gradient(135deg, rgba(122,162,255,.28), rgba(110,231,255,.12));
      border-color: rgba(122,162,255,.55);
    }

    main{padding:18px 0 40px;}
    .grid{
      display:grid;
      grid-template-columns: 360px 1fr;
      gap:14px;
      align-items:start;
    }
    @media (max-width: 980px){
      .grid{grid-template-columns:1fr}
    }

    .card{
      background: linear-gradient(180deg, rgba(17,26,51,.78), rgba(15,23,48,.78));
      border:1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .card .hd{
      padding:14px 14px 12px;
      border-bottom:1px solid var(--border);
      display:flex;
      justify-content:space-between;
      gap:10px;
      align-items:center;
    }
    .card .hd h2{
      margin:0;
      font-size:13.5px;
      letter-spacing:.2px;
      text-transform:uppercase;
      color:var(--muted);
    }
    .card .bd{padding:14px;}
    label{display:block;font-size:12.5px;color:var(--muted);margin:10px 0 6px}
    input[type="text"], select{
      width:100%;
      padding:10px 11px;
      border-radius:12px;
      border:1px solid var(--border);
      background: rgba(9,13,28,.55);
      color: var(--text);
      outline:none;
    }
    input[type="text"]::placeholder{color:rgba(169,182,230,.65)}
    .row{display:flex;gap:10px;flex-wrap:wrap}
    .row > *{flex:1}
    .btn{
      padding:10px 12px;
      border-radius:12px;
      border:1px solid var(--border);
      background: rgba(9,13,28,.55);
      color:var(--text);
      cursor:pointer;
      font-weight:650;
      transition: transform .08s ease, border-color .2s ease;
    }
    .btn:hover{transform:translateY(-1px); border-color: rgba(110,231,255,.45)}
    .btn.primary{
      background: linear-gradient(135deg, rgba(122,162,255,.38), rgba(110,231,255,.16));
      border-color: rgba(122,162,255,.55);
    }
    .btn.ok{
      background: linear-gradient(135deg, rgba(46,229,157,.25), rgba(110,231,255,.08));
      border-color: rgba(46,229,157,.45);
    }
    .btn.bad{
      background: linear-gradient(135deg, rgba(255,107,139,.22), rgba(122,162,255,.08));
      border-color: rgba(255,107,139,.45);
    }
    .stat{
      font-family:var(--mono);
      font-size:12.5px;
      color:var(--muted);
      padding:10px 12px;
      border-radius:12px;
      border:1px solid var(--border);
      background: rgba(9,13,28,.35);
      line-height:1.35;
    }

    .list{
      display:flex;
      flex-direction:column;
      gap:10px;
    }
    .qa{
      border:1px solid var(--border);
      border-radius:14px;
      padding:12px 12px 10px;
      background: rgba(9,13,28,.35);
    }
    .qtop{
      display:flex;
      justify-content:space-between;
      gap:10px;
      align-items:flex-start;
    }
    .qid{
      font-family:var(--mono);
      font-size:12px;
      color:rgba(169,182,230,.85);
      white-space:nowrap;
    }
    .qtext{
      font-weight:750;
      font-size:14px;
      line-height:1.35;
      margin:0 0 8px 0;
    }
    .meta{
      color:var(--muted);
      font-size:12px;
      margin-top:3px;
    }
    .answer{
      margin-top:10px;
      border-top:1px dashed rgba(255,255,255,.14);
      padding-top:10px;
      display:none;
      white-space:pre-wrap;
      font-family:var(--mono);
      font-size:12.5px;
      line-height:1.45;
      color:rgba(232,238,255,.92);
    }
    .answer.show{display:block}
    .actions{
      display:flex;
      gap:8px;
      flex-wrap:wrap;
      margin-top:8px;
    }

    .examBox{
      border:1px solid var(--border);
      border-radius:16px;
      padding:14px;
      background: rgba(9,13,28,.35);
    }
    .examQ{
      font-size:15px;
      font-weight:800;
      line-height:1.35;
      margin:0 0 10px 0;
    }
    .examAid{
      color:var(--muted);
      font-family:var(--mono);
      font-size:12px;
      margin-bottom:10px;
    }
    .examAnswer{
      white-space:pre-wrap;
      font-family:var(--mono);
      font-size:12.5px;
      line-height:1.45;
      border-top:1px dashed rgba(255,255,255,.14);
      padding-top:10px;
      margin-top:10px;
      display:none;
    }
    .examAnswer.show{display:block}
    .pill{
      display:inline-block;
      padding:6px 10px;
      border-radius:999px;
      border:1px solid var(--border);
      background: rgba(9,13,28,.35);
      color:var(--muted);
      font-size:12px;
      font-family:var(--mono);
    }
    .footnote{
      color:rgba(169,182,230,.75);
      font-size:12px;
      line-height:1.35;
    }
    .kbd{
      font-family:var(--mono);
      font-size:12px;
      padding:2px 6px;
      border-radius:8px;
      border:1px solid rgba(255,255,255,.16);
      background: rgba(0,0,0,.25);
      color: rgba(232,238,255,.92);
    }
  </style>
</head>
<body>
<header>
  <div class="wrap">
    <div class="toprow">
      <div>
        <h1>Datenkommunikation 1 – Lernapp (Textfragen)</h1>
        <div class="subtitle">
          Enthält nur Aufgaben, die man „normal durch Text beantworten“ kann (Rechen-/Zeichenaufgaben ausgelassen).<br>
          Modi: <b>Lernen</b> (mit Filter/Suche) und <b>Prüfung</b> (Shuffle, Selbstbewertung, Score).
        </div>
      </div>
      <div class="tabs" role="tablist" aria-label="Modi">
        <button class="tabbtn active" id="tabStudy" role="tab" aria-selected="true">Lernmodus</button>
        <button class="tabbtn" id="tabExam" role="tab" aria-selected="false">Prüfungsmodus</button>
      </div>
    </div>
  </div>
</header>

<main>
  <div class="wrap">
    <div class="grid">
      <!-- Left: Controls -->
      <section class="card" id="panelLeft">
        <div class="hd">
          <h2>Steuerung</h2>
          <span class="pill" id="countPill">0 Fragen</span>
        </div>
        <div class="bd" id="studyControls">
          <label for="search">Suche (Frage/Antwort/ID)</label>
          <input id="search" type="text" placeholder='z. B. "WLAN", "OSI", "Cookies", "IPv6"' />

          <div class="row">
            <div>
              <label for="chapter">Kapitel/Block</label>
              <select id="chapter"></select>
            </div>
            <div>
              <label for="sort">Sortierung</label>
              <select id="sort">
                <option value="id_asc">Nummer ↑</option>
                <option value="id_desc">Nummer ↓</option>
                <option value="rand">Zufällig</option>
              </select>
            </div>
          </div>

          <div class="row" style="margin-top:10px">
            <button class="btn primary" id="toggleAll">Alle Lösungen einblenden</button>
            <button class="btn" id="hideAll">Alle Lösungen ausblenden</button>
          </div>

          <div style="margin-top:12px" class="stat" id="statsBox"></div>

          <div style="margin-top:12px" class="footnote">
            Tipp: In der Liste kannst du pro Karte die Lösung ein-/ausblenden. Im Prüfungsmodus nutzt du <span class="kbd">Leertaste</span> (Lösung),
            <span class="kbd">J</span> (richtig) und <span class="kbd">N</span> (falsch).
          </div>
        </div>

        <div class="bd" id="examControls" style="display:none">
          <label for="examChapter">Prüfungs-Block</label>
          <select id="examChapter"></select>

          <label for="examCount">Anzahl Fragen (Shuffle)</label>
          <input id="examCount" type="text" placeholder="z. B. 10 (leer = alle)" />

          <div class="row" style="margin-top:10px">
            <button class="btn primary" id="startExam">Prüfung starten</button>
            <button class="btn" id="resetExam">Zurücksetzen</button>
          </div>

          <div style="margin-top:12px" class="stat" id="examStats">
            Noch keine Prüfung gestartet.
          </div>

          <div style="margin-top:12px" class="footnote">
            Ablauf: Frage beantworten → Lösung anzeigen → selbst bewerten (richtig/falsch) → nächste Frage.
          </div>
        </div>
      </section>

      <!-- Right: Content -->
      <section class="card" id="panelRight">
        <div class="hd">
          <h2 id="rightTitle">Lernmodus</h2>
          <span class="pill" id="modePill">STUDY</span>
        </div>
        <div class="bd">
          <div id="studyView">
            <div class="list" id="qaList"></div>
          </div>

          <div id="examView" style="display:none">
            <div class="examBox">
              <div class="examAid" id="examAid">—</div>
              <div class="examQ" id="examQ">Starte eine Prüfung, um zu beginnen.</div>

              <div class="actions">
                <button class="btn" id="examShow">Lösung anzeigen (Space)</button>
                <button class="btn ok" id="examYes">Richtig (J)</button>
                <button class="btn bad" id="examNo">Falsch (N)</button>
                <button class="btn primary" id="examNext">Nächste Frage</button>
              </div>

              <div class="examAnswer" id="examAnswer"></div>
            </div>
          </div>
        </div>
      </section>
    </div>
  </div>
</main>

<script>
/**
 * Datenbasis: NUR Textfragen. Lösungen sind 1:1 wie im PDF-Ausschnitt.
 * Hinweis: Rechen-/Zeichenaufgaben sind ausgelassen.
 */
const QA = [
  // =========================
  // 1 Einführung und Grundlagen
  // =========================
  {
    id:"1.1.1",
    block:"1 Einführung und Grundlagen",
    question:"Definieren Sie den Begriff Rechnernetz!",
    answer:"≥2 Knoten/Rechner: Über Übertragungsmedium (Kanten) +Kommunikationskomponenten\nmiteinander verbunden"
  },
  {
    id:"1.1.2",
    block:"1 Einführung und Grundlagen",
    question:"Welche 4 Anforderungen lassen sich an Rechnernetze stellen?",
    answer:"kostengünstig\nsicher (vertraulich)\nzuverlässig\neffizient\nressourcenschonend"
  },
  {
    id:"1.1.3",
    block:"1 Einführung und Grundlagen",
    question:"Welche 3 Verbundtypen kennen Sie im Kontext der Rechnernetze?",
    answer:"Datenverbund\nLastverbund\nVerfügbarkeitsverbund\nBetriebsmittelverbund\nFunktionsverbund"
  },
  {
    id:"1.1.4",
    block:"1 Einführung und Grundlagen",
    question:"Aus welchen Komponenten bestehen Rechnernetze typischerweise?",
    answer:"Rechner/Knoten (des Netzwerkgraphen)\nHardware-Kommunikationskomponenten:\nNetzwerkkarten, Switches/Hubs, Repeater\nÜbertragungsmedien/Kanten (des Netzwerkgraphen): Luft, Cu-Kabel"
  },
  {
    id:"1.1.5",
    block:"1 Einführung und Grundlagen",
    question:"Welche Komponenten werden in WANs (Wide Area Network) benötigt, die normalerweise nicht innerhalb von LANs eingesetzt \nwerden?",
    answer:"Router, Modem (machen aus Bits „Pfeiftöne“)"
  },
  {
    id:"1.1.6",
    block:"1 Einführung und Grundlagen",
    question:"Nennen Sie zwei Aufgaben, deren Lösung leistungsfähige Netzwerkbetriebssysteme über die reine Datenkommunikation hinaus \nanbieten müssen.",
    answer:"Adressierungsdienste\nInformationsdienste, z.B. Authentifikation (Login-Daten bei Server nachfragen), Zeitsynchronisation"
  },

  // =========================
  // 1.2 OSI-Modell
  // =========================
  {
    id:"1.2.1",
    block:"1 Einführung und Grundlagen",
    question:"Beschreiben Sie das Philosophenmodell in eigenen Worten!",
    answer:"mehrere Maschinen/Philosophen unterhalten sich mittels Übersetzern über eine einzige, gemeinsame (andere) Sprache"
  },
  {
    id:"1.2.2",
    block:"1 Einführung und Grundlagen",
    question:"Nennen Sie 3 Ziele, die mit dem OSI-Modell verfolgt werden.",
    answer:"1) Reduktion der Komplexität\n2) Standardisierung (Schnittstellen)\na) zweiten Anbieter ermöglichen, wenn einer ausfällt + b) Kosten drücken (Konkurrenz) \n3) Fehlersuche vereinfachen"
  },
  {
    id:"1.2.3",
    block:"1 Einführung und Grundlagen",
    question:"Welche schichtenspezifische Aufgaben kommen den einzelnen Schichten des OSI-Modells zu?",
    answer:"1. Bitübertragungsschicht:\nBits in Signale umsetzen und umgekehrt\n2. Sicherungsschicht:\nFehlererkennung\nFehlerkorrektur\nFlusskontrolle\nggf. Medienzugriffssteuerung\n3. Vermittlungsschicht/Netzwerkschicht:\nVermittlung zwischen Subnetzen\nErstellung und Verwendung von Routingtabellen\n4. Transportschicht:\nInterprozesskommunikation (sorgt dafür, dass innerhalb des Endgeräts der Prozess die Daten bekommt)\nDatenstrom in Segmente zerlegen und ggf. wieder richtig zusammenbauen\n5. Sitzungsschicht:\nSynchronisationspunkte bereitstellen, Verbindungen zwischen Anwendungen/Prozessen auf- und abbauen\nLogin-Infos\n6. Darstellungsschicht:\nZeichensatzanpassung (Codepage)\nVerschlüsselung\nKomprimierung\n7. Anwendungsschicht:\nKommunikationsdienste bereitstellen:\nDateitransfer, Mailing, Webbrowsing\nd.h lesen, schreiben, abspeichern, Namenszuordnung"
  },
  {
    id:"1.2.4",
    block:"1 Einführung und Grundlagen",
    question:"Unterscheiden Sie zwischen Dienst und Protokoll!",
    answer:"Dienst: Funktion\nProtokoll: Zeitlicher Ablauf"
  },
  {
    id:"1.2.5",
    block:"1 Einführung und Grundlagen",
    question:"Definieren Sie die Begriffe „Offenes System“, n-Schicht, n-Instanz, Partnerinstanz!",
    answer:"Offenes System:\nJeder kann mitmachen, Beiträge liefern, herstellerübergreifend\nkein proprietäres System (fester Herstellerstandard), wo keiner sonst genau weiß, wie das genau funktioniert\nn-Schicht:\nStück Papier: Spezifikation \"Bauplan\"\nn-Instanz:\nStück Software, Hardware aktives/lebendiges! System\nSchicht wird als Instanz implementiert\nPartnerinstanz:\nZwei Instanzen auf gleicher Schichthöhe"
  },
  {
    id:"1.2.6",
    block:"1 Einführung und Grundlagen",
    question:"Zwischen welchen Schichten im OSI-Modell wird direkt bzw. indirekt kommuniziert?",
    answer:"Horizontal: Nur in Bitübertragungsschicht direkt, sonst indirekt\nVertikal: Nur direkt benachbarte Instanzen direkt, sonst indirekt"
  },
  {
    id:"1.2.7",
    block:"1 Einführung und Grundlagen",
    question:"Wozu dienen die schichtenspezifischen Nachrichtenheader?",
    answer:"Adressierungsinformation, Sequenznummer, Prüfinfos (Paritätsbits, CRC-Code), Versionsinformation"
  },

  // =========================
  // 2 Grundlagen der Datenübertragung (nur Textaufgaben)
  // =========================
  {
    id:"2.1.1",
    block:"2 Grundlagen der Datenübertragung",
    question:"Was ist Aufgabe der Bitübertragungsschicht?",
    answer:"Bits in physische (physikalische) Signale umwandeln\n(Rauschen/Störungen berücksichtigen)"
  },
  {
    id:"2.1.2",
    block:"2 Grundlagen der Datenübertragung",
    question:"Was ist ein Signal?",
    answer:"Zeitlich veränderliche physische bzw. physikalische Größe"
  },
  {
    id:"2.1.3",
    block:"2 Grundlagen der Datenübertragung",
    question:"Unterscheiden Sie analoge, digitale, isochrone und anisochrone Signale!",
    answer:"analog: bezieht sich auf den Wertebereich, jeder Wert ist erlaubt, Zeit spielt keine Rolle\ndigital: wertdiskret, begrenzte Anzahl fester erlaubter Werte, Zwischenwerte nicht erlaubt\nisochron: zeitdiskret, (gleicher) Takt, Wert kann erst zum nächsten Zeitabschnitt geändert werden\nanisochron: zu jedem Zeitpunkt kann Wert geändert werden, muss aber nicht"
  },
  {
    id:"2.1.4",
    block:"2 Grundlagen der Datenübertragung",
    question:"Definieren Sie die Begriffe Schritt- und Übertragungsgeschwindigkeit!",
    answer:"Schrittgeschwindigkeit:\nAnzahl der möglichen Signalparameteränderungen pro Sekunde [baud] bzw. [1/s]\nÜbertragungsgeschwindigkeit:\nInformationsmenge pro Sekunde [bit/s]\nbzw. Dü = vs*log2k"
  },
  {
    id:"2.2.1",
    block:"2 Grundlagen der Datenübertragung",
    question:"Beschreiben Sie den Zweck und die Voraussetzungen der Theoreme von Nyquist und Shannon!",
    answer:"Nyquist: idealer Kanal\nShannon: gestörter bzw. verrauschter Kanal mit Gaußschem Rauschen\n(Realer Kanal, AWGN: Additiv white Gaussian noise)\nZweck von beiden: Dümax bestimmen bzw. Kanalkapazität"
  },
  {
    id:"2.2.2",
    block:"2 Grundlagen der Datenübertragung",
    question:"Definieren Sie die Begriffe Latenz, Signallaufzeit, Übertragungszeit und Round-Trip-Time!",
    answer:"Latenz: (bis Datenblock vollständig vom Sender zum Empfänger übertragen wurde)\ntL = ts + tü + tw\nSignallaufzeit:\nt\ns=\nl\nva\n(Zeit, wie lange ein kurzer Spannungsimpuls von Sender zu Empfänger braucht)\n(l: Kabellänge va: Ausbreitungsgeschwindigkeit)\nÜbertragungszeit:\nt\nü=\nn\nDü\n(Zeit er Übertragung vom Beginn des ersten Bits bis zum Ende des letzten Bits)\nRound-Trip-Time:\ntRT = 2 · tL"
  },

  // =========================
  // 3 Übertragungsverfahren und -medien (nur Textaufgaben)
  // =========================
  // 3.1.1 ist Zeichnen → ausgelassen
  {
    id:"3.1.2",
    block:"3 Übertragungsverfahren und -medien",
    question:"Wo liegen die Vorteile der Manchester-Kodierung im Vergleich zur NRZ-Kodierung?",
    answer:"NRZ Manchester\nKein Gleichanteil X √\nErkennung einfacher Fehler X √\nTaktrückgewinnung\n(oder Taktsynchronisation)\nX √\n(Nachteil: doppelter Bandbreitenbedarf wegen Signalwechsel)"
  },
  {
    id:"3.1.2",
    block:"3 Übertragungsverfahren und -medien",
    question:"Wo liegen die Vorteile der Manchester-Kodierung im Vergleich zur NRZ-Kodierung?",
    answer:`NRZ Manchester
Kein Gleichanteil X √
Erkennung einfacher Fehler X √
Taktrückgewinnung
(oder Taktsynchronisation)
X √
(Nachteil: doppelter Bandbreitenbedarf wegen Signalwechsel)`
  },
  {
    id:"3.2.1",
    block:"3 Übertragungsverfahren und -medien",
    question:"Erklären Sie den Unterschied zwischen synchronem und asynchronem Zeitmultiplexing!",
    answer:`Synchrones Zeitmultiplexing:
feste Zeitscheiben bzw. Takt der Zeitscheiben definiert
Asynchrones Zeitmultiplexing: Adressen`
  },
  {
    id:"3.3.1",
    block:"3 Übertragungsverfahren und -medien",
    question:"Vergleichen Sie unterschiedliche Glasfasertypen bzw. Lichtwellenleiter!",
    answer:`Multimode-Stufenfaser Multimode-Gradientenfaser Monomodefaser
Bandbreiten-Längen-Produkt Gering: 100 MHz km Mittel: 1 GHz km Hoch: 10 GHz km
Reichweiten Gering Mittel Hoch
Dämpfung Hoch Mittel Gering`
  },

  // 6.1 LAN
  {
    id:"6.1.1",
    block:"6 LANs und Zugriffsverfahren",
    question:"Nennen Sie 3 typische, wesentliche Eigenschaften eines LANs!",
    answer:`Kurze Entfernung! → geringe Dämpfung → störsicher
→ Bandbreiten-Längen-Produkt → hohes Dü,max (hohe Bandbreite!)
→ kostengünstig!
→ kleine Latenz!
volle Admin-Hoheit`
  },
  {
    id:"6.1.2",
    block:"6 LANs und Zugriffsverfahren",
    question:"Welche 3 Zugriffssteuerungsverfahren kennen Sie und wie lassen diese sich klassifizieren?",
    answer:`TDMA, koordiniert
Token, koordiniert
ALOHA, wahlfrei (wahlfrei: jeder kann senden wann er will)
CSMA/CD, wahlfrei`
  },
  {
    id:"6.1.3",
    block:"6 LANs und Zugriffsverfahren",
    question:"Beschreiben Sie das CSMA-Verfahren zur Zugriffssteuerung!",
    answer:`1. Verfahren: 0-persistent: kurz vor Senden abhören und wenn Kanal frei senden
2. Verfahren: 1-persistent CSMA: Dauerhaftes Abhören, wenn Kanal belegt,
 wenn frei → senden
Kollision: Zufallszeit warten + neuer Versuch`
  },

  // 6.4 / 6.5 WLAN (nur Text)
  {
    id:"6.4.1",
    block:"6 LANs und Zugriffsverfahren",
    question:"Wie hoch ist die Schrittgeschwindigkeit (Anzahl Signaländerungen pro Bit) eines IEEE 802.3-LANs mit 10 Mbit/s?",
    answer:`Breitbandverfahren: Modulation
Basisbandverfahren: Leitungskodierung → Manchesterkodierung
Dü=10 M bit
s
vs=
2 Schritte
bit ⋅Dü=2⋅
1
bit⋅10 M bit
s
=20 M
1
s
=20 M baud (2 Schritte bzw. 2 Pegel pro Bit)`
  },
  {
    id:"6.5.1",
    block:"6 LANs und Zugriffsverfahren",
    question:"Worin unterscheiden sich die WLAN-Standards?",
    answer:`Frequenzbereich (2,4 GHz, 5 GHz), Dü,max (→ kleine Latenz),
Modulationsverfahren (QAM (Quadratur Amplituden Modulation, gehört zu OSI 1), OFDM),
MIMO (Multiple Input, Multiple Output, mehrere Antennen),...`
  },
  {
    id:"6.5.2",
    block:"6 LANs und Zugriffsverfahren",
    question:"Welcher Frequenzbereich wird von WLAN verwendet?",
    answer:`2,4 GHz, 5 GHz`
  },
  {
    id:"6.5.3",
    block:"6 LANs und Zugriffsverfahren",
    question:"Können zwei Access Points räumlich überlappend störungsfrei auf dem gleichen Kanal arbeiten?",
    answer:`arbeiten: ja störungsfrei: nein`
  },
  {
    id:"6.5.4",
    block:"6 LANs und Zugriffsverfahren",
    question:"Welche Modulationsverfahren werden von WLAN verwendet?",
    answer:`QAM (Quadrature Amplitude Modulation),
OFDM (Orthogonal Frequency-Division Multiplexing/Orthogonales Frequenzmultiplexverfahren, bessere Bandbreitenausnutzung)`
  },
  {
    id:"6.5.5",
    block:"6 LANs und Zugriffsverfahren",
    question:"Welches Zugriffsverfahren wird von WLAN verwendet und wie funktioniert es?",
    answer:`CSMA/CA (Carrier Sense Multiple Access Collision Avoidance)
1. CSMA (nicht in laufende Sendung funken d.h. stören)
2. Reservierung mit Rückbestätigung vor der Sendung
3. Sendung
4. Bestätigung`
  },
  {
    id:"6.5.7",
    block:"6 LANs und Zugriffsverfahren",
    question:"Welche Sicherheitsmechanismen können im WLAN verwendet werden?",
    answer:`Keine,
WEP, WPA, WPA2, WPA3 → Verschlüsselung
MAC-Adressen-Filterung`
  },
  {
    id:"6.5.8",
    block:"6 LANs und Zugriffsverfahren",
    question:"Was passiert, wenn Bluetooth und WLAN gleichzeitig am gleichen Ort eingesetzt werden?",
    answer:`Arbeiten beide? → ja
BT→ Frequenzhopping → "hüpft" im WLAN herum
BT merkt, wenn im entsprechenden Frequenzband gesendet wird
(BT verwendet einzelne 79 Basiskanäle direkt, während WLAN einige Basiskanäle koppelt)`
  },

  // 7 Hubs / Bridges / Switches
  {
    id:"7.1.1",
    block:"7 Kopplung von LANs",
    question:"Was ist der Zweck von Hubs? Auf welcher OSI-Schicht arbeitet ein Hub?",
    answer:`Kopplung von LANs: Verteilung von Signalen
→ OSI-Schicht 1 → Gesamte Kollisionsdomäne
(Zweck: Verstärken von Signalen + Weiterleiten an alle Anschlüsse)`
  },
  {
    id:"7.1.2",
    block:"7 Kopplung von LANs",
    question:"Was sind die Vor- und Nachteile von Hubs gegenüber anderen Netzelementen zur Kopplung von LANs?",
    answer:`Nachteile: Gesamtes Netz ist Kollisionsdomäne
→ Weniger Datendurchsatz
→ Mögliches Sicherheitsproblem: Abhören
Vorteile: kostengünstig
Einfache Inbetriebnahme
kleine Latenz
gleichzeitiges Abhören aller Signale (aller Hardware-Ports bzw. eines beliebigen Hardware-Ports → leichte Fehlersuche möglich)`
  },
  {
    id:"7.2.1",
    block:"7 Kopplung von LANs",
    question:"Auf welcher OSI-Schicht arbeitet eine Bridge? Wie ermöglichen transparente Brücken eine korrekte Filterung der MAC-Adressen?",
    answer:`OSI-Schicht 2 (immer die höchste Schicht nennen)
Wie ermöglichen transparente Brücken eine korrekte Filterung der MAC-Adressen?
Backward-Learning:
Abhören der Quell-MAC-Adressen ↔(zuordnen zu) Hardware-Ports
→ Aufbau einer Tabelle`
  },
  {
    id:"7.2.2",
    block:"7 Kopplung von LANs",
    question:"Ein Unternehmen betreibt 3 Ethernet-Segmente, die über zwei Brücken in einem linearen Netz verbunden sind. Als der Netzwerkverwalter kündigt, wird er hastig durch einen Token-Ring-Spezialisten ersetzt, der sofort durch eine weitere transparente Brücke die beiden Enden des Netzes verbindet. Was passiert in der beschriebenen Konfiguration?",
    answer:`(Kleine Kreise in Abbildung: Maschinen)
→ nicht zyklenfrei
→ "kreisende" Rahmen
→ Problem! → Spanning-Tree-Verfahren => jedes LAN-Segment wird nur von einer Brücke versorgt
 Spanning-Tree-Verfahren → überflüssige Brücken werden vom Nutzdatenverkehr abgeschaltet
( → Baum ohne Schleifen)
1 LAN-Segment wird immer nur durch eine Brücke versorgt → kein Kreisen von Daten mehr
Brücke mit kleinster Kennung hat Priorität
→ B1 ist Wurzelbrücke
B2 und B3 sind jeweils 1 LAN-Segment von Wurzelbrücke B1 entfernt
→ L3 wird durch B2 versorgt, wegen kleinerer Kennung bei gleicher Entfernung zur Wurzelbrücke
B1 versorgt L1 und L2, B2 versorgt L3 und B3 versorgt nichts
Vorteil dieser Verschaltung: Redundanz, Absicherung gegen Ausfall`
  },
  {
    id:"7.3.1",
    block:"7 Kopplung von LANs",
    question:"Was bedeutet der Backplane-Durchsatz eines Switches? Wie groß ist dieser im Idealfall?",
    answer:`Gesamtdurchsatz aller parallel laufenden Datenströme F230
Wie groß ist dieser im Idealfall?
Anzahl der HW-Ports *2 (Idealfall; Senden + Empfangen) * Dü,max,Einzel`
  },
  {
    id:"7.3.2",
    block:"7 Kopplung von LANs",
    question:"Wieso besitzt ein managebarer Switch, wie dieser in der Vorlesung vorgestellt wird, eine eigene MAC-Adresse?",
    answer:`(MAC-Adresse für Konfiguration von Webserver, Konfiguration wird dann auf Switch angewendet)`
  },
  {
    id:"7.3.3",
    block:"7 Kopplung von LANs",
    question:"Durch welchen Mechanismus / Konfiguration kann ein Switch wie ein Hub oder Splitter eingesetzt werden?",
    answer:`Port Mirroring`
  },

  // 8 Routing (nur Text)
  {
    id:"8.1.5",
    block:"8 Routing",
    question:"Nennen Sie ein Routing-Protokoll, dass das Distanzvektor-Routing verwendet!",
    answer:`Routing Information Protocol (RIP)`
  },

  // 9 Überlastkontrolle (Text)
  {
    id:"9.1.1",
    block:"9 Überlastkontrolle",
    question:"Welche Verfahrensklassen zur Überlastkontrolle auf der OSI-Schicht 3 gibt es?",
    answer:`Open Loop, Closed Loop F273
Hostbasiert, Routerbasiert`
  },
  {
    id:"9.1.2",
    block:"9 Überlastkontrolle",
    question:"Charakterisieren Sie Traffic Shaping!",
    answer:`Open Loop (Router bekommt keine Rückkopplung)
Host- & Routerbasiert
(vorwiegend)`
  },

  // 10 Internet Protocol (Textteile)
  {
    id:"10.1.1",
    block:"10 Internet Protocol",
    question:"Zu welchem Routing-Typ gehört CIDR?",
    answer:`Hierarchisches Routing F267
Hierarchisches Routing → Routing-Tabellen mit übergeordneten Netzen
Weitere Routingverfahren: Backward-Learning Distanzvektor-Routing Flooding`
  },
  {
    id:"10.1.2",
    block:"10 Internet Protocol",
    question:"Welche Möglichkeit sollten Sie mit der Netzwerk-Administration in London diskutieren?",
    answer:`Empfehlung: Mengengerüst zu klein?, 4 C-Klasse-Netze als Minimum (2n
)`
  },
  {
    id:"10.2.1",
    block:"10 Internet Protocol",
    question:"Nennen Sie 4 wichtige Bestandteile eines Routingseintrages in einer Routing-Tabelle.",
    answer:`Destination Network Address Ziel-Netzwerkadresse
Subnet Mask Subnetzmaske
Next Hop Nächster Router
Network Device Netzwerkkarte /Schnittstelle als IP-Adresse`
  },
  {
    id:"10.2.3",
    block:"10 Internet Protocol",
    question:"Erläutern Sie die Wirkung der obigen Tabelle auf das IP-Routing.",
    answer:`Routing über Schnittstelle: 192.168.1.2 → 192.168.0.0/24, 192.168.1.0/24
192.168.2.1 → 192.168.2.0/24
Routing nach 192.168.0.0 ist indirekt über Router 192.168.1.1
192.168.1.1 ist der Default Router für Internet`
  },
  {
    id:"10.3.1",
    block:"10 Internet Protocol",
    question:"Nennen Sie 3 wichtige Unterschiede zwischen IPv4 und IPv6.",
    answer:`IPv6:
Adressumfang ist wesentlich größer Notation in Hex statt Dezimal
einfacherer Header → erweiterbar
nur Classless Interdomain Routing, keine A- ,B- , C-Klassen (nur noch Sunetzmaske)
Bessere QoS-Unterstützung
Multihoming (mehrere IP-Adressen für 1 Maschine für verschiedene Dienste möglich), Autokonfiguration möglich`
  },
  {
    id:"10.3.3",
    block:"10 Internet Protocol",
    question:"Welche Maßnahmen bietet IPv6 zur Wahrung der Privatsphäre?",
    answer:`Privacy Extension: Zweite IPv6-Adresse → dynamisch (Änderung z.B. alle 24 h)`
  },

  // 11 Transportprotokolle
  {
    id:"11.1.2",
    block:"11 Transportprotokolle",
    question:"In welcher Reihenfolge werden die einzelnen Kommunikationsschritte durchgeführt?",
    answer:`F343
s.o. in 3 Phasen:
1,2,3,(4) 5 6
Phase 1 Phase 2 Phase 3
Phase1: Verbindungsaufbau, erst Server dann Client,
Phase2: Nutzdatenphase, Datenaustausch
Phase3: Verbindungsabbau`
  },
  {
    id:"11.1.3",
    block:"11 Transportprotokolle",
    question:"Welche Kommunikationsschritte gehören zu welchem Zustand einer verbindungsorientierten Client-Server-Kommunikation?",
    answer:`F343
Verbindungsaufbau: Server öffnet passiv Socket, wartet
Client öffnet aktiv Socket, kontaktiert Server
Datenaustausch: gegenseitiges Senden und Empfangen (von Nutzdaten)
Verbindungsabbau: Sockets schließen`
  },
  {
    id:"11.1.4",
    block:"11 Transportprotokolle",
    question:"Welches sind die zugehörigen Bibliotheksfunktionen für die Client-Server-Kommunikation in der Programmiersprache C unter Unix?",
    answer:`F344
(mindestens 3 kennen: socket(), send(), recv() )`
  },
  {
    id:"11.2.1",
    block:"11 Transportprotokolle",
    question:"Was sind die Vor- und Nachteile von UDP und TCP im direkten Vergleich zueinander?",
    answer:`UDP: verbindungslos → leichtgewichtig (wenig Daten), schnell, (kein Verbindungsaufbau)
TCP: verbindungsorientiert → gesicherte Übertragung, Reihenfolge korrekt, vollständig, bestätigt
"langsam" für kleine Datenmengen
→ große Datenmengen`
  },
  {
    id:"11.2.2",
    block:"11 Transportprotokolle",
    question:"Wozu dient die MSS? (optimale Datenmenge, die verschickt werden soll)",
    answer:`MSS beachten, sonst Fragmentierung
→ voll ausschöpfen, sonst großer Overhead in Relation`
  },
  {
    id:"11.2.3",
    block:"11 Transportprotokolle",
    question:"Wie funktioniert die Überlastkontrolle bei TCP? F370",
    answer:`Slow-Start und AIMD (additiv increase multiple decrease)
definiert wird dadurch die Anzahl der unbestätigten Segmente
(Text reicht)`
  },

  // 12 Anwendungsprotokolle
  {
    id:"12.1.1",
    block:"12 Anwendungsprotokolle",
    question:"Wie sieht beispielhaft eine HTTP-Anfrage (Request) aus?",
    answer:`HTTP-Request (OSI-Schicht 7)
kleinste URL: /
Kurzform: Get˽/˽HTTP/1.0 CR LF CR LF`
  },
  {
    id:"12.1.3",
    block:"12 Anwendungsprotokolle",
    question:"Wie sind zwei aufeinanderfolgende HTTP-Requests auf HTTP-Ebene verknüpft?",
    answer:`keine Verknüpfung auf HTTP-Ebene`
  },
  {
    id:"12.1.4",
    block:"12 Anwendungsprotokolle",
    question:"Wie lassen sich zwei beliebige HTTP-Requests verknüpfen?",
    answer:`Information auf Anwendungsebene: URL-Rewriting (individualisierte URL mit bestimmter Zahl)
Cookies
...`
  },

  // 12.2 E-Mail (12.2.1 ist im Auszug ohne Lösung, daher nicht enthalten)
  {
    id:"12.2.2",
    block:"12 Anwendungsprotokolle",
    question:"Wie werden E-Mails geroutet? Welche Datei konfiguriert das E-Mail-Routing?",
    answer:`Von E-Mail-Servern wird die E-Mail gezielt an andere E-Mail-Server weitergesendet. Dies muss nicht direkt der Ziel-E-Mail-Server sein.
(Eigene Routingtabellen für Emailversand (entspricht nicht IP-Routing) )
Welche Datei konfiguriert das E-Mail-Routing?
sendmail.conf konfigurieren`
  },
  {
    id:"12.2.3",
    block:"12 Anwendungsprotokolle",
    question:"Welche Möglichkeiten gibt es zum Empfang von E-Mails?",
    answer:`PoP3: Herunterladen der E-Mails komplett
IMAPv4: E-Mail-Server wie E-Mail-Datenbank`
  },
  {
    id:"12.2.4",
    block:"12 Anwendungsprotokolle",
    question:"Kann ermittelt werden, ob ein bestimmter User auf einem E-Mail-Server einen Account hat?",
    answer:`Ja (wenn nicht Abfrage gesperrt ist)`
  },
  {
    id:"12.2.5",
    block:"12 Anwendungsprotokolle",
    question:"Nennen Sie einen Mechanismus zur Minimierung von Spam-E-Mails.",
    answer:`Blacklisting/Sperrliste von Absendern`
  },

  // 12.3 FTP
  {
    id:"12.3.1",
    block:"12 Anwendungsprotokolle",
    question:"Wie sieht die Kommunikationsstruktur von FTP aus?",
    answer:`Aktives FTP:
1. FTP-Client initiiert TCP-Verbindung (Steuerkanal) auf Server-Port 21
2. FTP-Server initiiert TCP-Verbindung (Datenkanal) von Server-Port 20 auf signalisiertem Client-Port
(Passiv: Client initiiert beide Verbindungen
Grund: Firewall: Verbindungen nur von innen nach außen erlaubt)`
  },
  {
    id:"12.3.2",
    block:"12 Anwendungsprotokolle",
    question:"Was der Vorteil einer Out-of-Band-Control (OOB)?",
    answer:`Keine Vermischung von Steuerdaten und Nutzdaten auf dem gleichen, logischen Kanal`
  },
  {
    id:"12.3.3",
    block:"12 Anwendungsprotokolle",
    question:"Welcher OSI-Schicht ist der ASCII- oder BINARY-Mode von FTP zuzuordnen? Was bewirkt dieser?",
    answer:`OSI-Schicht 6 (Darstellungsschicht)
Was bewirkt dieser?
Gleiche Darstellung auf verschiedenen Plattformen
→ Nutzdaten werden entsprechend durch FTP geändert!`
  },

  // 13 Netzstrukturen
  {
    id:"13.1.2",
    block:"13 Netzstrukturen und Informationssysteme",
    question:"Durch welche Komponenten und Maßnahmen garantiert eine Web-Architektur Anforderungen wie Skalierbarbeit, Sicherheit und Benutzbarkeit?",
    answer:`Anforderung Maßnahme
Skalierbarkeit Komponenten sind vervielfachbar
Webserver partitionieren → aufteilen in Teilbereiche
Reserven: "gute" Kabel, …
Upgrade von Netzwerkschnittstelle
Sicherheit Firewalls
Benutzerauthentifizierung
Admin-Passwörter (Sonderzeichen etc vorschreiben)
Organisatorische Sicherheit → Schulung
Benutzbarkeit End-Geräteunabhängigkeit MVC-Konzept
Model View Controler (Konfig-Datei auf Smartphones für Darstellung)
Mehrsprachigkeit
User-Help-Desk
Ergonomische Reaktionszeiten (leistungsfähige Systeme)
einfaches/übersichtliches Programmierdesign
Übersichtliches Web-Design`
  },
  {
    id:"13.2.1",
    block:"13 Netzstrukturen und Informationssysteme",
    question:"Aus welchen Komponenten besteht die XAMPP-Suite?",
    answer:`(A: Apache-Webserver M: Mysql-DB Sammlung von Programmen)
Apache-Webserver
MySQL-DB
Tomcat-Applicationserver`
  },
  {
    id:"13.2.2",
    block:"13 Netzstrukturen und Informationssysteme",
    question:"Welche Probleme, die durch die Verwendung des HTTP entstehen, muss eine Web-Architektur beim Einsatz eines Warenkorbs und eines Bezahlvorganges lösen?",
    answer:`1) Unverschlüsselte Übertragung: Sicherheit, Datenintegrität (besser https → verschlüsselt)
2) Gedächtnisloses Protokoll: Authentifizierung der 2. Anfrage, Verknüpfung der Daten der 1. und 2. Anfrage`
  },
  {
    id:"13.2.3",
    block:"13 Netzstrukturen und Informationssysteme",
    question:"Welche Möglichkeiten bietet die XAMPP-Suite für die Einführung von Sessions und die effiziente Nutzung von Datenbankverbindungen an?",
    answer:`Sessions: Cookies, URL-Rewriting (Tomcat → Sessions einstellen)
für effiziente Nutzung Datenbankverbindungen: Connection-Pooling`
  },
  {
    id:"13.3.1",
    block:"13 Netzstrukturen und Informationssysteme",
    question:"Wie sieht die typische Netzstruktur eines Internet Service Providers (ISP) oder eines Großunternehmens aus?",
    answer:`(IP4-Paket → in IP6-Paket verpacken)
(Vom ISP: DSL-Router (Gateway), damit wird das eigene Netz Teil des Netzes vom ISP
Basisstationen gehen zu Masterswitch, der mit anderen Netzen weiter vernetzt ist
Kernnetz: Dienste: Emailserver, DNS-Server, Kundendaten, verschiedene ISP sind untereinander gekoppelt)`
  },
  {
    id:"13.3.2",
    block:"13 Netzstrukturen und Informationssysteme",
    question:"Wie sieht die Vernetzung von ISPs untereinander aus?",
    answer:`Direkt über Edge-Router (schnell, schlau)`
  },
  {
    id:"13.3.3",
    block:"13 Netzstrukturen und Informationssysteme",
    question:"Wie erhält ein Endkunde eines ISPs eine öffentlich sichtbare, routingfähige IPv4-Adresse?",
    answer:`• Kapselung von privaten IPv4-Paketen in IPv6-Paketen innerhalb des Autonomen Systems des ISP (=ISP-Netz)
• An der Grenze des Autonomen Systems erhält der Endkunde durch NAT / PAT am Edge Router temporär eine öffentlich (sichtbare) IPv4-
Adresse (wird wieder umgepackt).
(Dual Stack (früher) → Dual Stack Lite (getrickst, eingeschränkte Funktionalität))`
  },

  // 15 WWW / NAT
  {
    id:"15.1.1",
    block:"15 Internetworking für das WWW",
    question:"Welche Schritte sind vor dem eigentlichen Versand der Web-Anfrage notwendig?",
    answer:`(ARP (Adress Resolution Protocol): IP-Adresse (DNS-Server oder Router) → MAC-Adresse DNS-Server)
1) !DNS (Domain Name System): FQDN der URL → IP-Adresse des Webservers
(Wenn der Webserver im selben LAN liegt, wird vor TCP…. ein ARP-Request verschickt:
ARP: IP-Adresse(Webserver) → MAC-Adresse des Webservers)
Namensauflösung über DNS + TCP-Verbindung
2) !TCP: Verbindungsaufbau vom Client zum Webserver → Port-Nr, IP-Adresse des Webclients wird an Webserver übermittelt
(hier: Webserver ohne Router im Intranet erreichbar)`
  },
  {
    id:"15.2.1",
    block:"15 Internetworking für das WWW",
    question:"Wie muss der Webclient und der Web-Proxy konfiguriert werden?",
    answer:`Webclient: z.B. manuelle Angabe des Web-Proxy (IP-Adresse und Portnummer 8080) in Einstellungen des Webclient
Web-Proxy: IP-Adresse des NAT-Router (interne Seite) als "Standardgateway"`
  },
  {
    id:"15.2.3",
    block:"15 Internetworking für das WWW",
    question:"Wie verändern sich die Adressen der Antwort des Webservers auf dem Rückweg (kurze Antwort ohne alle Adressen detailliert zu nennen)?",
    answer:`Quell- und Zieladressen der Anfrage werden vertauscht.
Bei HTTP entfällt die URL.`
  }
];

// --------------------- Helpers ---------------------
const byId = (id)=>document.getElementById(id);
const norm = (s)=> (s||"").toLowerCase();
function shuffle(arr){
  const a = arr.slice();
  for(let i=a.length-1;i>0;i--){
    const j = Math.floor(Math.random()*(i+1));
    [a[i],a[j]]=[a[j],a[i]];
  }
  return a;
}
function unique(arr){ return [...new Set(arr)]; }

// --------------------- Study rendering ---------------------
let showAll = false;

function getChapters(){
  return ["Alle"].concat(unique(QA.map(x=>x.block)));
}
function populateSelect(sel, chapters){
  sel.innerHTML = "";
  chapters.forEach(c=>{
    const o=document.createElement("option");
    o.value=c; o.textContent=c;
    sel.appendChild(o);
  });
}

function filterQA({q, block}){
  let data = QA.slice();
  if(block && block!=="Alle") data = data.filter(x=>x.block===block);
  if(q){
    const nq=norm(q);
    data = data.filter(x =>
      norm(x.id).includes(nq) ||
      norm(x.question).includes(nq) ||
      norm(x.answer).includes(nq)
    );
  }
  return data;
}

function sortQA(data, sort){
  if(sort==="id_desc") return data.slice().sort((a,b)=> (a.id<b.id?1:-1));
  if(sort==="rand") return shuffle(data);
  return data.slice().sort((a,b)=> (a.id>b.id?1:-1));
}

function renderStudy(){
  const q = byId("search").value.trim();
  const block = byId("chapter").value;
  const sort = byId("sort").value;

  let data = sortQA(filterQA({q, block}), sort);

  byId("countPill").textContent = `${data.length} Fragen`;
  byId("statsBox").textContent =
`Filter: ${block}
Suchbegriff: ${q ? `"${q}"` : "—"}
Sichtbar: ${data.length} / ${QA.length}
Lösungen global: ${showAll ? "AN" : "AUS"}`;

  const list = byId("qaList");
  list.innerHTML = "";

  data.forEach(item=>{
    const el = document.createElement("div");
    el.className="qa";

    const top = document.createElement("div");
    top.className="qtop";

    const left = document.createElement("div");
    left.style.flex="1";

    const qid = document.createElement("div");
    qid.className="qid";
    qid.textContent = item.id;

    const qtext = document.createElement("div");
    qtext.className="qtext";
    qtext.textContent = item.question;

    const meta = document.createElement("div");
    meta.className="meta";
    meta.textContent = item.block;

    left.appendChild(qid);
    left.appendChild(qtext);
    left.appendChild(meta);

    const right = document.createElement("div");
    right.style.display="flex";
    right.style.gap="8px";

    const btn = document.createElement("button");
    btn.className="btn";
    btn.textContent = "Lösung";
    btn.addEventListener("click", ()=>{
      ans.classList.toggle("show");
    });

    right.appendChild(btn);

    top.appendChild(left);
    top.appendChild(right);

    const ans = document.createElement("div");
    ans.className="answer";
    ans.textContent = item.answer;

    if(showAll) ans.classList.add("show");

    el.appendChild(top);
    el.appendChild(ans);
    list.appendChild(el);
  });
}

// --------------------- Exam mode ---------------------
let exam = {
  running:false,
  deck:[],
  idx:0,
  correct:0,
  wrong:0,
  revealed:false
};

function buildDeck(){
  const block = byId("examChapter").value;
  let deck = QA.slice();
  if(block && block!=="Alle") deck = deck.filter(x=>x.block===block);
  deck = shuffle(deck);

  const nRaw = byId("examCount").value.trim();
  if(nRaw){
    const n = Math.max(1, Math.min(deck.length, parseInt(nRaw,10) || deck.length));
    deck = deck.slice(0,n);
  }
  return deck;
}

function examStatusText(){
  if(!exam.running) return "Noch keine Prüfung gestartet.";
  return `Frage ${exam.idx+1}/${exam.deck.length}
Richtig: ${exam.correct}
Falsch: ${exam.wrong}
Lösung angezeigt: ${exam.revealed ? "ja" : "nein"}`;
}

function renderExam(){
  byId("examStats").textContent = examStatusText();

  if(!exam.running || exam.deck.length===0){
    byId("examAid").textContent = "—";
    byId("examQ").textContent = "Starte eine Prüfung, um zu beginnen.";
    byId("examAnswer").classList.remove("show");
    byId("examAnswer").textContent = "";
    return;
  }

  const item = exam.deck[exam.idx];
  byId("examAid").textContent = `${item.id} · ${item.block}`;
  byId("examQ").textContent = item.question;
  byId("examAnswer").textContent = item.answer;
  byId("examAnswer").classList.toggle("show", exam.revealed);
}

function startExam(){
  exam.deck = buildDeck();
  exam.idx = 0;
  exam.correct = 0;
  exam.wrong = 0;
  exam.revealed = false;
  exam.running = exam.deck.length>0;
  renderExam();
}

function nextExam(){
  if(!exam.running) return;
  exam.idx++;
  exam.revealed = false;
  if(exam.idx >= exam.deck.length){
    exam.running = false;
    byId("examStats").textContent =
`Fertig.
Richtig: ${exam.correct}
Falsch: ${exam.wrong}
Score: ${exam.correct}/${exam.correct+exam.wrong}`;
  }
  renderExam();
}

function mark(correct){
  if(!exam.running) return;
  if(correct) exam.correct++;
  else exam.wrong++;
  byId("examStats").textContent = examStatusText();
}

function toggleReveal(){
  if(!exam.running) return;
  exam.revealed = !exam.revealed;
  renderExam();
}

// --------------------- Mode switching ---------------------
function setMode(mode){
  const study = mode==="study";
  byId("studyControls").style.display = study ? "" : "none";
  byId("examControls").style.display = study ? "none" : "";
  byId("studyView").style.display = study ? "" : "none";
  byId("examView").style.display = study ? "none" : "";

  byId("tabStudy").classList.toggle("active", study);
  byId("tabExam").classList.toggle("active", !study);
  byId("rightTitle").textContent = study ? "Lernmodus" : "Prüfungsmodus";
  byId("modePill").textContent = study ? "STUDY" : "EXAM";
}

// --------------------- Init ---------------------
(function init(){
  const chapters = getChapters();
  populateSelect(byId("chapter"), chapters);
  populateSelect(byId("examChapter"), chapters);

  byId("countPill").textContent = `${QA.length} Fragen`;

  byId("search").addEventListener("input", renderStudy);
  byId("chapter").addEventListener("change", renderStudy);
  byId("sort").addEventListener("change", renderStudy);

  byId("toggleAll").addEventListener("click", ()=>{
    showAll = !showAll;
    byId("toggleAll").textContent = showAll ? "Alle Lösungen ausblenden" : "Alle Lösungen einblenden";
    renderStudy();
  });
  byId("hideAll").addEventListener("click", ()=>{
    showAll = false;
    byId("toggleAll").textContent = "Alle Lösungen einblenden";
    renderStudy();
  });

  byId("tabStudy").addEventListener("click", ()=> setMode("study"));
  byId("tabExam").addEventListener("click", ()=> setMode("exam"));

  byId("startExam").addEventListener("click", startExam);
  byId("resetExam").addEventListener("click", ()=>{
    exam = {running:false, deck:[], idx:0, correct:0, wrong:0, revealed:false};
    renderExam();
  });

  byId("examShow").addEventListener("click", toggleReveal);
  byId("examYes").addEventListener("click", ()=> mark(true));
  byId("examNo").addEventListener("click", ()=> mark(false));
  byId("examNext").addEventListener("click", nextExam);

  // Keyboard shortcuts in exam mode
  document.addEventListener("keydown", (e)=>{
    const examVisible = byId("examView").style.display !== "none";
    if(!examVisible) return;

    if(e.code==="Space"){ e.preventDefault(); toggleReveal(); }
    if(e.key==="j" || e.key==="J"){ mark(true); }
    if(e.key==="n" || e.key==="N"){ mark(false); }
  });

  renderStudy();
  renderExam();
})();
</script>
</body>
</html>
